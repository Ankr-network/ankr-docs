# Cubist-powered security

To protect the Ankr validators' private keys, [Ankr has teamed up with Cubist](https://www.ankr.com/blog/securing-upcoming-eth-withdrawals-with-cubist/?search=cubist&page=1) — a Polychain-backed company that specializes in high-security web3 development and deployment tools. Cubist's team including industry veterans and professors from CMU and UCSD who are leading experts in cryptography and computer security drives an HSM approach to managing private keys.

## Problem
This way, we're solving the problem of compromizing private keys which is notoriously long-resolved: if a key is compromised, you need to transfer all assets to another address, which is deposit withdrawal and — a compromised key can lead to double-signing and slashing, while fixing it you lose your validator rewards.

## Solution
Now, instead of keeping private keys to the validators within the company, Ankr switches to **remote signing** and lets Cubist securely store them in an HSM, a hardware security module with a dedicated crypto processor that is specifically designed for the protection of the crypto key lifecycle. The HSM is replicated in different location in case one of the location suffers a natural disaster such as flood or earthquake damaging the hardware.

Whenever Ankr needs a signature, our server calculates what needs to be signed, sends a signature request to Cubist who checks no double-signing happened then signs the data.

### Ankr's main signing activities
There are two main activities Ankr needs signatures for: block validation and withdrawal from validators to distribute Liquid Staking rewards among stakers.<br/>
1. For block validation, we create short-lived tokens and lets our validators use these tokens to authenticate signing requests to Cubist when validating and publishing blocks to network. Additionally, we can use short-lived tokens to decrypt an HSM backup in case of an emergency, such as if all the HSM replicas are dead, which is unlikely to happen with the Cubist's geo-distributed replication policy.
2. For withdrawals from validators (unstakes), we create long-lived tokens with a higher security level, only whitelisting our server's IPs in Cubists to accept such tokens and restricting the unstake amount. In case our users make a very big unstake, and we need to temporarily increase the amount, the majority of YubiKey holders within the company have to sign to create a new token.

### In case of an attack
1. If a short-lived token gets stolen and used for malicious activities such as double-signing to slash the validator and demand ransom for stopping doing so, the Cubist notifies us after the first double-signing event, and we quickly issue a new token, rendering the attacker's actions useless. We use multiple hardware tokens such as YubiKey and a JWT-like mechanics for creating tokens, which eliminates the possibility for an attacker to issue a new token.
2. If a long-lived tokens gets stolen, the attacker won't be able to withdraw any assets to a custom address, since they can only be withdrawn to a set address. And again, we use multiple hardware tokens such as YubiKey and a JWT-like mechanics for creating tokens, which eliminates the possibility for an attacker to issue a new token.

## Official news and more details
You can read the official announcement on [Ankr Blog](https://www.ankr.com/blog/securing-upcoming-eth-withdrawals-with-cubist/?search=cubist&page=1).<br/>
For more details on Cubist, read "[Securing staking keys properly](https://cubist.dev/blog/staking-keys-status-quo) on their blog.



