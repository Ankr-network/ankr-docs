# Security

To protect Ankr validators' private keys, Ankr has teamed up with Cubist â€” a Polychain-backed company that specializes in high-security Web3 development and deployment tools. Cubist's team that includes industry veterans and professors from CMU and UCSD who are leading experts in cryptography and computer security drives an HSM approach to managing private keys.

## Problem
The problem we had to tackle is losing validator's rewards: if a validator's key is compromised, there is a significant risk of double-signing and subsequent slashing; even if you quickly exit (unstake) funds from such a validator, the exiting process is long enough, and you will keep losing rewards until it is complete and a new key gets in action.

## Solution
Instead of keeping validators' private keys inside the company, Ankr switches to **remote signing** and storing the keys in HSM.

HSM is a hardware security module with a dedicated crypto processor that is specifically designed to protect crypto key's lifecycle.

Using HSM protects us from attacks where an attacker steals a validator's private key and plans to demand ransom otherwise creating double-signing events that lead to the validator's slashing and loss of money for the company.

If you ask how...

First, HSM securely stores our keys and runs various security checks whenever it receives a signing request.
Second, to send any signing request, we use short-lived and long-lived keys that we issue via **multiple hardware tokens**.
1. Short-lived tokens are used to authenticate signing requests from validators they publish blocks to the network. These tokens secure us from double-signing and subsequent slashing. If an attacker somehow manages to steal it, they only have that single token. HSM alerts us at the first double-singing event and we quickly issue and register a new short-lived token, rendering the attacker's actions useless.
2. Long-lived tokens are used to authenticate signing request when unstaking, i.e., withdrawing from our validators. These tokens along with whitelisting only our server IP, restricting the unstake amount, and more, secure us from any attacker meddling with our unstakes. Moreover, validators only allow withdrawing to the pre-programmed address that belongs to Ankr, not a custom one.

## Mechanics of remote signing
The mechanics are very simple:
1. Our server calculates what needs to be signed.
2. We send a signing request to HSM which runs multiple checks, including the double-signing check.
3. If all checks pass, HSM signs the data. Otherwise, we're immediately alerted if any malicious actions have been detected.

## Additional details
HSM is protected from physical damage by being replicated in multiple geo-locations. In case of an unlikely emergency event where all the replicas are damaged, we can apply the majority of our hardware tokens to decrypt an HSM backup.

In case our users make a very big unstake, we can temporarily adjust the security policy concerning the unstaking amount by using our hardware keys.

## Official news and more information
[Official announcement](https://www.ankr.com/blog/securing-upcoming-eth-withdrawals-with-cubist/?search=cubist&page=1) on Ankr Blog.<br/>
Also, read "[Securing staking keys properly](https://cubist.dev/blog/staking-keys-status-quo)".



